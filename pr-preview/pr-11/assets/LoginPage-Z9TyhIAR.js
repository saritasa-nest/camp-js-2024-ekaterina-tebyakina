import{r as d,t as _,x as E,l as e,y as S,A as j,z as b,D as w,E as y}from"./index-kyksIeFb.js";import{S as p,i as L,a as P,z as m,u as F,P as T,t as A}from"./server-error.mapper-B1CI5lSp.js";import{T as g}from"./TextField-IKTe-aB6.js";function W(r){if(r!==p.Password&&r!==p.Email)throw new Error(`${r} is not a valid name of form field!`)}function M(r,a){if(L(r)&&r.response){r.response.data.errors.map(s=>P.fromDto(s)).forEach(s=>{if(s.attribute){W(s.attribute),a(s.attribute,{type:"serverError",message:s.detail});return}a("root",{type:"serverError",message:s.detail})});return}console.error(r),a("root",{type:"serverError",message:"Failed to register"})}const N="_formWrapper_1xnmn_1",q="_header_1xnmn_11",k="_form_1xnmn_1",z="_errorMessage_1xnmn_26",t={formWrapper:N,header:q,form:k,errorMessage:z},D=m.object({email:m.string({required_error:"This field is required"}).email("Please provide a valid email"),password:m.string({required_error:"This field is required"})}),B=()=>{const r=_(),a=E(),[i,s]=d.useState(!1),{register:c,handleSubmit:u,setError:f,formState:{errors:o,isValid:h}}=F({mode:"onBlur",resolver:A(D)}),x=async n=>{s(!0);try{const l=await j.login(n);b.saveTokens(l),r(w()),a(y)}catch(l){M(l,f)}s(!1)},v=n=>{!i&&h&&x(n)};return e.jsxs("div",{className:t.formWrapper,children:[e.jsx("h2",{className:t.header,children:"Log in"}),e.jsxs("form",{onSubmit:u(v),className:t.form,children:[e.jsx(g,{label:"Email",type:"email",variant:"outlined",fullWidth:!0,placeholder:"ivan.pupkin@gmail.com",...c("email",{required:!0}),error:!!o.email,helperText:o.email?o.email.message:""}),e.jsx(g,{label:"Password",type:"password",variant:"outlined",fullWidth:!0,placeholder:"veryStrongPassW0rd",...c("password"),error:!!o.password,helperText:o.password?o.password.message:""}),o.root?e.jsx("span",{className:t.errorMessage,children:o.root.message}):"",i?e.jsx(T,{}):null,e.jsx(S,{type:"submit",variant:"outlined",children:"Login"})]})]})},C=d.memo(B),I=()=>e.jsx(e.Fragment,{children:e.jsx(C,{})}),V=d.memo(I);export{V as LoginPage};
