import{r as c,t as y,x as P,l as s,y as E,A as N,z as b,D as S,E as _}from"./index-kyksIeFb.js";import{c as j,S as p,i as T,a as q,z as a,u as F,P as W,t as A}from"./server-error.mapper-B1CI5lSp.js";import{T as n}from"./TextField-IKTe-aB6.js";function R(r){if(!j(r,p))throw new Error(`${r} is not a valid name of form field!`);if(r===p.Avatar||r===p.NonField)throw new Error(`${r} is not a valid name of form field!`)}function k(r,o){if(T(r)&&r.response){r.response.data.errors.map(t=>q.fromDto(t)).forEach(t=>{if(t.attribute){R(t.attribute),o(t.attribute,{type:"serverError",message:t.detail});return}o("root",{type:"serverError",message:t.detail})});return}console.warn("Failed to register"),o("root",{type:"serverError",message:"Failed to register"})}const I="_formWrapper_1nmxp_1",L="_header_1nmxp_11",z="_form_1nmxp_1",u={formWrapper:I,header:L,form:z},C=a.object({email:a.string({required_error:"This field is required"}).email("Please provide a valid email"),firstName:a.string({required_error:"This field is required"}),lastName:a.string({required_error:"This field is required"}),password:a.string({required_error:"This field is required"}),retypedPassword:a.string({required_error:"This field is required"})}).refine(r=>r.password===r.retypedPassword,{message:"Passwords do not match",path:["retypedPassword"]}),D=()=>{var f;const r=y(),o=P(),[l,t]=c.useState(!1),{register:i,handleSubmit:h,setError:g,formState:{errors:e,isValid:x}}=F({mode:"onBlur",resolver:A(C)}),v=async d=>{t(!0);try{const m=await N.register(d);b.saveTokens(m),r(S()),o(_)}catch(m){k(m,g)}t(!1)},w=d=>{!l&&x&&v(d)};return s.jsxs("div",{className:u.formWrapper,children:[s.jsx("h2",{className:u.header,children:"Register"}),s.jsxs("form",{onSubmit:h(w),className:u.form,children:[s.jsx(n,{label:"Email",type:"email",variant:"outlined",fullWidth:!0,placeholder:"ivan.pupkin@gmail.com",...i("email",{required:!0}),error:!!e.email,helperText:e.email?e.email.message:""}),s.jsx(n,{label:"First name",type:"text",variant:"outlined",fullWidth:!0,placeholder:"Ivan",...i("firstName"),error:!!e.firstName,helperText:e.firstName?(f=e.firstName)==null?void 0:f.message:""}),s.jsx(n,{label:"Last name",type:"text",variant:"outlined",fullWidth:!0,placeholder:"Pupkin",...i("lastName"),error:!!e.lastName,helperText:e.lastName?e.lastName.message:""}),s.jsx(n,{label:"Password",type:"password",variant:"outlined",fullWidth:!0,placeholder:"veryStrongPassW0rd",...i("password"),error:!!e.password,helperText:e.password?e.password.message:""}),s.jsx(n,{label:"Confirm the password",type:"password",variant:"outlined",fullWidth:!0,placeholder:"veryStrongPassW0rd",...i("retypedPassword"),error:!!e.retypedPassword,helperText:e.retypedPassword?e.retypedPassword.message:""}),l?s.jsx(W,{}):null,s.jsx(E,{type:"submit",variant:"outlined",children:"Register"})]})]})},M=c.memo(D),B=()=>s.jsx(s.Fragment,{children:s.jsx(M,{})}),V=c.memo(B);export{V as RegistrationPage};
