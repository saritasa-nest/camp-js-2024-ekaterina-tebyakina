import{d as R,_ as f,i as B,o as H,j as t,a as V,g as $,s as N,r as u,u as Z,e as G,f as J,k as L,p as K,l as E,m as F,S as q,q as b,T as Q,F as X,t as Y,v as ee,w as te,x as re,A as se,y as ae,z as oe,C as ne}from"./index-D7jTh2nF.js";import{B as T,P as O,z as P,u as le,t as ie,h as ce}from"./handleServerErrors-DB6pINmg.js";import{r as de,d as pe}from"./Delete-Bn2fP_00.js";import{r as ue,m as me,c as fe,M as ge,T as S}from"./TextField-vCobeyp1.js";const ve=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],he=["component","slots","slotProps"],xe=["component"];function ye(e,r){const{className:l,elementType:s,ownerState:a,externalForwardedProps:o,getSlotOwnerState:i,internalForwardedProps:c}=r,n=R(r,ve),{component:x,slots:m={[e]:void 0},slotProps:g={[e]:void 0}}=o;R(o,he);const p=m[e]||s,d=ue(g[e],a),v=me(f({className:l},n,{externalForwardedProps:void 0,externalSlotProps:d})),{props:{component:I},internalRef:h}=v,C=R(v.props,xe),A=B(h,d==null?void 0:d.ref,r.ref),j=i?i(C):{},y=f({},a,j),w=I,k=fe(p,f({},e==="root",!m[e]&&c,C,w&&{as:w},{ref:A}),y);return Object.keys(j).forEach(_=>{delete k[_]}),[p,k]}const we=H(t.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function Pe(e){return V("MuiAvatar",e)}$("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const je=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],Se=e=>{const{classes:r,variant:l,colorDefault:s}=e;return J({root:["root",l,s&&"colorDefault"],img:["img"],fallback:["fallback"]},Pe,r)},be=N("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:l}=e;return[r.root,r[l.variant],l.colorDefault&&r.colorDefault]}})(({theme:e})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(e.vars||e).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:f({color:(e.vars||e).palette.background.default},e.vars?{backgroundColor:e.vars.palette.Avatar.defaultBg}:f({backgroundColor:e.palette.grey[400]},e.applyStyles("dark",{backgroundColor:e.palette.grey[600]})))}]})),Ce=N("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(e,r)=>r.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),Ae=N(we,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(e,r)=>r.fallback})({width:"75%",height:"75%"});function ke({crossOrigin:e,referrerPolicy:r,src:l,srcSet:s}){const[a,o]=u.useState(!1);return u.useEffect(()=>{if(!l&&!s)return;o(!1);let i=!0;const c=new Image;return c.onload=()=>{i&&o("loaded")},c.onerror=()=>{i&&o("error")},c.crossOrigin=e,c.referrerPolicy=r,c.src=l,s&&(c.srcset=s),()=>{i=!1}},[e,r,l,s]),a}const Re=u.forwardRef(function(r,l){const s=Z({props:r,name:"MuiAvatar"}),{alt:a,children:o,className:i,component:c="div",slots:n={},slotProps:x={},imgProps:m,sizes:g,src:p,srcSet:d,variant:v="circular"}=s,I=R(s,je);let h=null;const C=ke(f({},m,{src:p,srcSet:d})),A=p||d,j=A&&C!=="error",y=f({},s,{colorDefault:!j,component:c,variant:v}),w=Se(y),[k,_]=ye("img",{className:w.img,elementType:Ce,externalForwardedProps:{slots:n,slotProps:{img:f({},m,x.img)}},additionalProps:{alt:a,src:p,srcSet:d,sizes:g},ownerState:y});return j?h=t.jsx(k,f({},_)):o||o===0?h=o:A&&a?h=a[0]:h=t.jsx(Ae,{ownerState:y,className:w.fallback}),t.jsx(be,f({as:c,ownerState:y,className:G(w.root,i),ref:l},I,{children:h}))}),W=L(e=>e.avatar.url,e=>e),Fe=L(e=>e.avatar.isLoading,e=>e),Ie=L(e=>e.avatar.error,e=>e);var D={},_e=K;Object.defineProperty(D,"__esModule",{value:!0});var z=D.default=void 0,Ue=_e(de()),Te=t;z=D.default=(0,Ue.default)((0,Te.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload");const Ne={opacity:0,position:"absolute",left:0,top:0,width:0,height:0},Le=({onUpload:e})=>{const r=E(),l=F(Ie),s=F(Fe),[a,o]=u.useState(null),[i,c]=u.useState(null);u.useEffect(()=>()=>{a&&URL.revokeObjectURL(a)},[a]);const n=g=>{var d;const p=(d=g.target.files)==null?void 0:d[0];p&&(c(p),o(URL.createObjectURL(p)))},x=()=>{if(i){const g={config:X.UserAvatars,filename:i.name,contentType:i.type,contentLength:i.size};r(Y({fileData:g,file:i})).unwrap().then(()=>e())}},m=u.useId();return t.jsxs(q,{direction:"column",spacing:1,sx:{alignItems:"center"},children:[t.jsx(T,{sx:Ne,children:t.jsx("input",{id:m,type:"file",accept:"image/*",onChange:n})}),t.jsx("label",{htmlFor:m,children:t.jsx(b,{variant:"text",component:"span",children:"Choose file"})}),a&&t.jsx(T,{component:"img",src:a,alt:"Avatar Preview",sx:{width:"150px",height:"150px",objectFit:"cover"}}),s?t.jsx(O,{}):null,l?t.jsx(Q,{component:"p",sx:{textAlign:"center",color:"error.main"},children:l}):null,i&&t.jsx(b,{type:"button",variant:"outlined",disabled:s,onClick:x,children:"Upload avatar"})]})},Ee=u.memo(Le),M=64,De=()=>{const e=E(),r=F(W),[l,s]=u.useState(!1),a=()=>s(!0),o=()=>{s(!1),e(ee())},i=()=>e(te());return t.jsxs(t.Fragment,{children:[t.jsxs(q,{direction:"row",spacing:1,sx:{width:"100%",alignItems:"center"},children:[t.jsx(Re,{alt:"User's avatar",src:r??"",sx:{width:M,height:M,cursor:"pointer"},onClick:a}),t.jsx(b,{variant:"outlined",startIcon:t.jsx(z,{}),onClick:a,children:"Select"}),t.jsx(b,{variant:"outlined",startIcon:t.jsx(pe,{}),onClick:i,children:"Delete"})]}),t.jsx(ge,{open:l,onClose:o,children:t.jsx(T,{sx:{position:"relative",top:"30%",left:"50%",width:400,transform:"translate(-50%, -50%)",bgcolor:"background.paper",p:4},children:t.jsx(Ee,{onUpload:o})})})]})},Me=u.memo(De),qe="_formWrapper_1nmxp_1",Oe="_header_1nmxp_11",We="_form_1nmxp_1",U={formWrapper:qe,header:Oe,form:We},ze=P.object({email:P.string().min(1,{message:"This field is required"}).email("Please provide a valid email"),firstName:P.string().min(1,{message:"This field is required"}),lastName:P.string().min(1,{message:"This field is required"}),password:P.string().min(1,{message:"This field is required"}),retypedPassword:P.string().min(1,{message:"This field is required"})}).refine(e=>e.password===e.retypedPassword,{message:"Passwords do not match",path:["retypedPassword"]}),Be=()=>{var p;const e=E(),r=re(),l=F(W),[s,a]=u.useState(!1),{register:o,handleSubmit:i,setError:c,formState:{errors:n,isValid:x}}=le({mode:"onBlur",resolver:ie(ze)}),m=async d=>{a(!0);try{const v=await se.register({...d,...l&&{avatar:l}});ae.saveTokens(v),e(oe()),r(ne)}catch(v){ce(v,c,d)}a(!1)},g=d=>{!s&&x&&m(d)};return t.jsxs("div",{className:U.formWrapper,children:[t.jsx("h2",{className:U.header,children:"Register"}),t.jsxs("form",{onSubmit:i(g),className:U.form,children:[t.jsx(Me,{}),t.jsx(S,{label:"Email",type:"email",variant:"outlined",fullWidth:!0,placeholder:"ivan.pupkin@gmail.com",...o("email",{required:!0}),error:n.email!=null,helperText:n.email?n.email.message:""}),t.jsx(S,{label:"First name",type:"text",variant:"outlined",fullWidth:!0,placeholder:"Ivan",...o("firstName"),error:n.firstName!=null,helperText:n.firstName?(p=n.firstName)==null?void 0:p.message:""}),t.jsx(S,{label:"Last name",type:"text",variant:"outlined",fullWidth:!0,placeholder:"Pupkin",...o("lastName"),error:n.lastName!=null,helperText:n.lastName?n.lastName.message:""}),t.jsx(S,{label:"Password",type:"password",variant:"outlined",fullWidth:!0,placeholder:"veryStrongPassW0rd",...o("password"),error:n.password!=null,helperText:n.password?n.password.message:""}),t.jsx(S,{label:"Confirm the password",type:"password",variant:"outlined",fullWidth:!0,placeholder:"veryStrongPassW0rd",...o("retypedPassword"),error:n.retypedPassword!=null,helperText:n.retypedPassword?n.retypedPassword.message:""}),s?t.jsx(O,{}):null,t.jsx(b,{type:"submit",variant:"outlined",disabled:s,children:"Register"})]})]})},He=u.memo(Be),Ve=()=>t.jsx(t.Fragment,{children:t.jsx(He,{})}),Ke=u.memo(Ve);export{Ke as RegistrationPage};
