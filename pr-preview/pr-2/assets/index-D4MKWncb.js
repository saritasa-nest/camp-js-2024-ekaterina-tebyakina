var p=Object.defineProperty;var x=(t,e,s)=>e in t?p(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var r=(t,e,s)=>x(t,typeof e!="symbol"?e+"":e,s);import"./modulepreload-polyfill-B5Qt9EMX.js";class o{constructor(){r(this,"subscribers",[]);r(this,"subscribe",e=>{this.getSubscriberIndex(e)===-1&&this.subscribers.push(e)});r(this,"unsubscribe",e=>{const s=this.getSubscriberIndex(e);s!==-1&&this.subscribers.splice(s,1)})}notify(e){this.subscribers.forEach(s=>s.update(e))}getSubscriberIndex(e){return this.subscribers.findIndex(s=>s===e)}}const S=6;class P extends o{constructor(){super(...arguments);r(this,"sidesCount",S);r(this,"rollDice",()=>1+Math.floor(Math.random()*this.sidesCount))}update(s){this.notify(s)}notify(s){const n=this.rollDice();this.subscribers.forEach((c,i)=>{s===i&&c.update(n)})}}const I=2;class R extends o{constructor(){super(...arguments);r(this,"playersCount",I);r(this,"currentPlayerIndex",-1);r(this,"calcCurrentPlayerIndex",()=>{if(this.currentPlayerIndex+1<this.playersCount){this.currentPlayerIndex+=1;return}this.currentPlayerIndex=0});r(this,"next",()=>{this.calcCurrentPlayerIndex(),this.notify(this.currentPlayerIndex)})}}const w=21;class y extends o{constructor(){super(...arguments);r(this,"diceResults",[]);r(this,"winStatus",!1)}checkIsWin(){this.calcSumOfPoints()>=w&&(this.winStatus=!0)}calcSumOfPoints(){let s=0;return this.diceResults.forEach(n=>{s+=n}),s}notify(s){this.subscribers.forEach(n=>n.update(s))}update(s){this.diceResults.push(s),this.checkIsWin(),this.notify({winStatus:this.winStatus,diceResult:s})}}class b{constructor(e){this.layout=e}update(e){this.layout.innerText=`${this.layout.innerText} ${String(e.diceResult)}`}}const C="#e0baba";class h extends b{update(e){if(this.layout.innerText=`${this.layout.innerText} ${String(e.diceResult)}`,e.winStatus){const s=this.layout.parentNode;s.style.backgroundColor=C}}}const f=new R,d=new P,a=new y,l=new y;f.subscribe(d);d.subscribe(a);d.subscribe(l);D();const u=document.querySelector(".button");u==null||u.addEventListener("click",()=>{f.next()});function D(){const t=document.querySelector(".first-player-results"),e=new h(t),s=document.querySelector(".second-player-results"),n=new h(s),c=document.querySelector(".all-results"),i=new b(c);a.subscribe(e),l.subscribe(n),a.subscribe(i),l.subscribe(i)}
